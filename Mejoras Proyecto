Mejoras a Futuro proyecto IOC

1- Acumulados / históricos
2- Guardar un snapshot diario de contadores (por fuente, por tag y fuente×tag) para gráficas y KPIs.
3- Endpoint JSON (p.ej. /api/counters/history) para consumirlos.
4- Limpieza/retención (ej. mantener 90 días).

UI (plantillas/JS)

6- Etiquetas (chips) por IP en la tabla (ya entrego ip_tags/tags en HTML/JSON, faltaría maquetarlo).
7- Contador de TTL restante en días (ya calculo ttl_remaining en JSON, faltaría pintarlo).
8- Botón/tabla para ver y filtrar el feed BPE en la UI (ahora existe el endpoint del feed, pero no hay vista).

API de “summary”

9- Un endpoint dedicado (p.ej. GET /api/summary) que devuelva justo los contadores (los de /metrics requieren login web).
10- Paginación/filtrado en GET /api/lista/<tag> (ahora devuelve todo).

Migraciones / datos existentes

11-Script de “backfill” para asignar by_ip (origen) y ip_details.tags a IPs viejas si venías de una versión previa sin meta.
12- Normalización de tags antiguos (case-insensitive → canónicos).

Mantenimiento y compactación

13-Compactar ficheros de tags (data/tags/*.txt): hoy escribimos “append-only”; conviene purgar entradas obsoletas/expiradas periódicamente.
14- Rotación de audit-log.jsonl y notif-log.json (tamaño/retención).
15- Rotación de backups (ya hay retención por días, pero puedes querer parametrizarla).

Seguridad / robustez

16- CSRF en formularios (Flask-WTF) si quieres endurecer el panel.
17- File locking simple al escribir feeds/meta en entornos con más concurrencia.
18- Hacer configurable por env: UNDO_TTL_SECONDS, IDEM_TTL_SECONDS, retención de backups y de históricos de contadores.

Experiencia de borrado

19- “Preview delete” hoy cuenta sólo sobre el feed principal; podrías añadir el impacto en BPE y mostrar ambos (principal/BPE).
20- Quitar tags por UI (ahora sólo por API DELETE /api/bloquear-ip con tags).

Observabilidad extra

21- Página de auditoría/descarga con filtros (actor, evento, IP).
22- Métricas adicionales: % por fuente, tendencia de altas/días, top redes añadidas.

Tests y docs

23- Tests unitarios para expansión de entradas, fusión de expiraciones/tags, y rutas clave.
24- README con variables de entorno, ejemplos de llamadas API (POST/DELETE), y formato de CSV.