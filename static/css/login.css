$(function () {
  'use strict';

  var _boxyLoginForm = document.forms['boxy-login-form'];
  var _boxyFormInner = $(_boxyLoginForm).find('div.boxy-form-inner');
  var _boxyWrap = $("#boxy-login-wrapper");
  var _boxyMessage = _boxyWrap.find('em.small-forgot'); // aunque ya no lo usamos

  // Usuario → validación y rotación
  $(_boxyFormInner).on('click', '.side.front button', function (evt) {
    evt.preventDefault();
    var _boxyInput = _boxyLoginForm['username'];
    if (!_boxyInput.value) {
      _boxyWrap.addClass('shake');
      _boxyInput.placeholder = 'Introduce tu usuario';
    } else {
      $(_boxyFormInner).addClass('rotated90');
    }
  });

  // Contraseña → enviar
  $(_boxyFormInner).on('click', '.side.bottom button', function (evt) {
    evt.preventDefault();
    var _boxyPassword = _boxyLoginForm['password'];
    if (!_boxyPassword.value) {
      _boxyWrap.addClass('shake');
      _boxyPassword.placeholder = 'Introduce tu contraseña';
    } else {
      _boxyLoginForm.submit();
    }
  });

  // Tab key → avanzar
  $(_boxyFormInner).on('keydown', '#boxy-input , #boxy-password', function (evt) {
    var keyCode = evt.keyCode || evt.which;
    if (keyCode == 9) {
      evt.preventDefault();
      $(this).next('button').click();
    }
  });
});
